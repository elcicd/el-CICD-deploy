<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>el-CICD Chart Tutorial</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge, pre.rouge .w {
  color: #24292f;
  background-color: #f6f8fa;
}
pre.rouge .k, pre.rouge .kd, pre.rouge .kn, pre.rouge .kp, pre.rouge .kr, pre.rouge .kt, pre.rouge .kv {
  color: #cf222e;
}
pre.rouge .gr {
  color: #f6f8fa;
}
pre.rouge .gd {
  color: #82071e;
  background-color: #ffebe9;
}
pre.rouge .nb {
  color: #953800;
}
pre.rouge .nc {
  color: #953800;
}
pre.rouge .no {
  color: #953800;
}
pre.rouge .nn {
  color: #953800;
}
pre.rouge .sr {
  color: #116329;
}
pre.rouge .na {
  color: #116329;
}
pre.rouge .nt {
  color: #116329;
}
pre.rouge .gi {
  color: #116329;
  background-color: #dafbe1;
}
pre.rouge .ges {
  font-weight: bold;
  font-style: italic;
}
pre.rouge .kc {
  color: #0550ae;
}
pre.rouge .l, pre.rouge .ld, pre.rouge .m, pre.rouge .mb, pre.rouge .mf, pre.rouge .mh, pre.rouge .mi, pre.rouge .il, pre.rouge .mo, pre.rouge .mx {
  color: #0550ae;
}
pre.rouge .sb {
  color: #0550ae;
}
pre.rouge .bp {
  color: #0550ae;
}
pre.rouge .ne {
  color: #0550ae;
}
pre.rouge .nl {
  color: #0550ae;
}
pre.rouge .py {
  color: #0550ae;
}
pre.rouge .nv, pre.rouge .vc, pre.rouge .vg, pre.rouge .vi, pre.rouge .vm {
  color: #0550ae;
}
pre.rouge .o, pre.rouge .ow {
  color: #0550ae;
}
pre.rouge .gh {
  color: #0550ae;
  font-weight: bold;
}
pre.rouge .gu {
  color: #0550ae;
  font-weight: bold;
}
pre.rouge .s, pre.rouge .sa, pre.rouge .sc, pre.rouge .dl, pre.rouge .sd, pre.rouge .s2, pre.rouge .se, pre.rouge .sh, pre.rouge .sx, pre.rouge .s1, pre.rouge .ss {
  color: #0a3069;
}
pre.rouge .nd {
  color: #8250df;
}
pre.rouge .nf, pre.rouge .fm {
  color: #8250df;
}
pre.rouge .err {
  color: #f6f8fa;
  background-color: #82071e;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cm, pre.rouge .cp, pre.rouge .cpf, pre.rouge .c1, pre.rouge .cs {
  color: #6e7781;
}
pre.rouge .gl {
  color: #6e7781;
}
pre.rouge .gt {
  color: #6e7781;
}
pre.rouge .ni {
  color: #24292f;
}
pre.rouge .si {
  color: #24292f;
}
pre.rouge .ge {
  color: #24292f;
  font-style: italic;
}
pre.rouge .gs {
  color: #24292f;
  font-weight: bold;
}
</style>
</head>
<body class="article">
<div id="header">
<h1>el-CICD Chart Tutorial</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_overview">1. Overview</a>
<ul class="sectlevel2">
<li><a href="#_starter_helm_chart">1.1. Starter Helm chart</a></li>
<li><a href="#_el_cicd_chart">1.2. el-CICD Chart</a></li>
</ul>
</li>
<li><a href="#_tutorial">2. Tutorial</a>
<ul class="sectlevel2">
<li><a href="#_add_and_update_the_el_cicd_chart_repository">2.1. Add and update the el-CICD Chart repository</a></li>
<li><a href="#_el_cicd_chart_templates">2.2. el-CICD Chart Templates</a></li>
<li><a href="#_compound_el_cicd_chart_templates">2.3. Compound el-CICD Chart Templates</a></li>
<li><a href="#_user_defined_variables">2.4. User-defined Variables</a></li>
<li><a href="#_deployment_profiles">2.5. Deployment Profiles</a></li>
<li><a href="#_free_form_templates">2.6. Free Form Templates</a></li>
<li><a href="#_remove_the_el_cicd_chart_repo">2.7. Remove the el-CICD Chart repo</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">Prerequisites</dt>
<dd>
<p>It is assumed the reader has at least a basic understanding of the following topics and technologies:</p>
<div class="ulist">
<ul>
<li>
<p>YAML</p>
</li>
<li>
<p>Docker/OCI images and containers</p>
</li>
<li>
<p>Application deployments in Kubernetes</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>No prior knowledge of Helm is required.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Software and tools required</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://kubernetes.io/docs/tasks/tools/"><code>kubectl</code></a> or other Kubernetes compatible client (e.g. <a href="https://docs.okd.io/latest/cli_reference/openshift_cli/getting-started-cli.html"><code>oc</code></a>) installed locally</p>
</li>
<li>
<p><a href="https://helm.sh/docs/intro/install/">Helm</a> installed locally</p>
</li>
<li>
<p>Access to a Kubernetes compatible cluster</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>This tutorial was written and tested on <a href="https://github.com/crc-org/crc">CRC</a>, a local OKD/OpenShift cluster provided by Red Hat for developer testing, and thus all URL&#8217;s in the tutorial will use the wildcard domain <code>*.app-crc.testing</code>.  Other desktop options for development testing of Kubernetes clusters like <a href="https://github.com/kubernetes/minikube">minikube</a> or <a href="https://kind.sigs.k8s.io/">kind</a> will work equally well.  Any Kubernetes compatible cluster will suffice for running the tutorial, as long as internet access is available to pull el-CICD Chart and the test image.  You will need to adjust your endpoint URL&#8217;s to your own cluster&#8217;s wildcard if not using CRC.</p>
</div>
<div class="paragraph">
<p>The tutorial will focus on deploying the <a href="https://httpd.apache.org/">Apache Web Server</a> using <a href="https://catalog.redhat.com/software/containers/ubi8/httpd-24/6065b844aee24f523c207943">Red Hat&#8217;s official image</a> and will not deploy Secrets, so that whether you are deploying on vanilla Kubernetes or a more security conscious cluster like OpenShift this tutorial will run smoothly with only basic developer permissions required.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview">1. Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Helm is an excellent package management tool for Kubernetes, but it falls short when it comes to defining Kubernetes manifests.  Creating templates in Helm can be difficult to learn and master, and it provides no support for basic Kubernetes resources or configuration management.</p>
</div>
<div class="sect2">
<h3 id="_starter_helm_chart">1.1. Starter Helm chart</h3>
<div class="paragraph">
<p>The following is the starter chart created by Helm when running <code>helm create my-new-chart</code> along with its issues:</p>
</div>
<details open>
<summary class="title">Service</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>apiVersion: v1
kind: Service
metadata:
  name: {{ include "my-new-chart.fullname" . }}
  labels:
    {{- include "my-new-chart.labels" . | nindent 4 }}
spec:
  type: {{ .Values.service.type }}
  ports:
    - port: {{ .Values.service.port }}
      targetPort: http
      protocol: TCP
      name: http
  selector:
    {{- include "my-new-chart.selectorLabels" . | nindent 4 }}</code></pre>
</div>
</div>
</div>
</details>
<details>
<summary class="title">Deployment</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="apiVersion: apps/v1">kind: Deployment
metadata:
  name: {{ include "my-new-chart.fullname" . }}
  labels:
    {{- include "my-new-chart.labels" . | nindent 4 }}
spec:
  {{- if not .Values.autoscaling.enabled }}
  replicas: {{ .Values.replicaCount }}
  {{- end }}
  selector:
    matchLabels:
      {{- include "my-new-chart.selectorLabels" . | nindent 6 }}
  template:
    metadata:
      {{- with .Values.podAnnotations }}
      annotations:
        {{- toYaml . | nindent 8 }}
      {{- end }}
      labels:
        {{- include "my-new-chart.selectorLabels" . | nindent 8 }}
    spec:
      {{- with .Values.imagePullSecrets }}
      imagePullSecrets:
        {{- toYaml . | nindent 8 }}
      {{- end }}
      serviceAccountName: {{ include "my-new-chart.serviceAccountName" . }}
      securityContext:
        {{- toYaml .Values.podSecurityContext | nindent 8 }}
      containers:
        - name: {{ .Chart.Name }}
          securityContext:
            {{- toYaml .Values.securityContext | nindent 12 }}
          image: "{{ .Values.image.repository }}:{{ .Values.image.tag | default .Chart.AppVersion }}"
          imagePullPolicy: {{ .Values.image.pullPolicy }}
          ports:
            - name: http
              containerPort: 80
              protocol: TCP
          livenessProbe:
            httpGet:
              path: /
              port: http
          readinessProbe:
            httpGet:
              path: /
              port: http
          resources:
            {{- toYaml .Values.resources | nindent 12 }}
      {{- with .Values.nodeSelector }}
      nodeSelector:
        {{- toYaml . | nindent 8 }}
      {{- end }}
      {{- with .Values.affinity }}
      affinity:
        {{- toYaml . | nindent 8 }}
      {{- end }}
      {{- with .Values.tolerations }}
      tolerations:
        {{- toYaml . | nindent 8 }}
      {{- end }}</code></pre>
</div>
</div>
</div>
</details>
<details>
<summary class="title">Ingress</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>{{- if .Values.ingress.enabled -}}
{{- $fullName := include "my-new-chart.fullname" . -}}
{{- $svcPort := .Values.service.port -}}
{{- if and .Values.ingress.className (not (semverCompare "&gt;=1.18-0" .Capabilities.KubeVersion.GitVersion)) }}
  {{- if not (hasKey .Values.ingress.annotations "kubernetes.io/ingress.class") }}
  {{- $_ := set .Values.ingress.annotations "kubernetes.io/ingress.class" .Values.ingress.className}}
  {{- end }}
{{- end }}
{{- if semverCompare "&gt;=1.19-0" .Capabilities.KubeVersion.GitVersion -}}
apiVersion: networking.k8s.io/v1
{{- else if semverCompare "&gt;=1.14-0" .Capabilities.KubeVersion.GitVersion -}}
apiVersion: networking.k8s.io/v1beta1
{{- else -}}
apiVersion: extensions/v1beta1
{{- end }}
kind: Ingress
metadata:
  name: {{ $fullName }}
  labels:
    {{- include "my-new-chart.labels" . | nindent 4 }}
  {{- with .Values.ingress.annotations }}
  annotations:
    {{- toYaml . | nindent 4 }}
  {{- end }}
spec:
  {{- if and .Values.ingress.className (semverCompare "&gt;=1.18-0" .Capabilities.KubeVersion.GitVersion) }}
  ingressClassName: {{ .Values.ingress.className }}
  {{- end }}
  {{- if .Values.ingress.tls }}
  tls:
    {{- range .Values.ingress.tls }}
    - hosts:
        {{- range .hosts }}
        - {{ . | quote }}
        {{- end }}
      secretName: {{ .secretName }}
    {{- end }}
  {{- end }}
  rules:
    {{- range .Values.ingress.hosts }}
    - host: {{ .host | quote }}
      http:
        paths:
          {{- range .paths }}
          - path: {{ .path }}
            {{- if and .pathType (semverCompare "&gt;=1.18-0" $.Capabilities.KubeVersion.GitVersion) }}
            pathType: {{ .pathType }}
            {{- end }}
            backend:
              {{- if semverCompare "&gt;=1.19-0" $.Capabilities.KubeVersion.GitVersion }}
              service:
                name: {{ $fullName }}
                port:
                  number: {{ $svcPort }}
              {{- else }}
              serviceName: {{ $fullName }}
              servicePort: {{ $svcPort }}
              {{- end }}
          {{- end }}
    {{- end }}
{{- end }}</code></pre>
</div>
</div>
</div>
</details>
<details>
<summary class="title">values.yaml</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code># Default values for my-new-chart.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

replicaCount: 1

image:
  repository: nginx
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: ""

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

podAnnotations: {}

podSecurityContext: {}
  # fsGroup: 2000

securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

service:
  type: ClusterIP
  port: 80

ingress:
  enabled: false
  className: ""
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  hosts:
    - host: chart-example.local
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls: []
  #  - secretName: chart-example-tls
  #    hosts:
  #      - chart-example.local

resources: {}
  # We usually recommend not to specify default resources and to leave this as a conscious
  # choice for the user. This also increases chances charts run on environments with little
  # resources, such as Minikube. If you do want to specify resources, uncomment the following
  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80

nodeSelector: {}

tolerations: []

affinity: {}</code></pre>
</div>
</div>
</div>
</details>
<div class="dlist">
<dl>
<dt class="hdlist1">Verbose</dt>
<dd>
<p>The files are verbose, and assume a good understanding of the manifests required to deploy an application on Kubernetes.</p>
</dd>
<dt class="hdlist1">Obtuse</dt>
<dd>
<p>Go Template syntax (everything between double-brackets) and the supporting Sprig library is not very user friendly, but it&#8217;s required knowledge to understand and change Helm templates.</p>
</dd>
<dt class="hdlist1">Brittle</dt>
<dd>
<p>Many common deployment practices aren&#8217;t supported; e.g. mounting a ConfigMap or defining environment variables in the container.  Deployments across multiple environments isn&#8217;t supported; e.g. during development or testing. This means structural changes will almost certainly be required.</p>
</dd>
<dt class="hdlist1">It&#8217;s code</dt>
<dd>
<p>Helm templates are code.  This means Helm charts need to be tested in isolation from the application they are meant to deploy if they are modified in any meaningful way.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_el_cicd_chart">1.2. el-CICD Chart</h3>
<div class="paragraph">
<p>el-CICD Chart was created with the intention of leveraging all the package management goodness Helm has to offer with the following quality-of-life productivity enhancements:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Simpler</dt>
<dd>
<p>Defining and templating deployment definitions should be simple and easy.  Beginners should be able to quickly get to work with little effort.  Experts should be able to define very complex deployments without fighting the tool that will define it.  Both should be able to read deployment definitions and templates easily with minimal training.  Deployment definitions and templates should NOT require testing outside of the context of what is being deployed.  Templates should be easy, modular, and intuitive to define.</p>
</dd>
<dt class="hdlist1">More concise</dt>
<dd>
<p>Follow the <a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself">DRY (Don&#8217;t Repeat Yourself) Principle</a> and aggressively and easily support and promote reuse of deployment definitions and templates.  As much as possible, define basic Kubernetes resources with reasonable defaults deployment definitions and templates are confined as much as possible to the problem at hand.</p>
</dd>
<dt class="hdlist1">Support configuration management</dt>
<dd>
<p>Deployments of applications in different configurations and environments is standard practice whether in development (e.g. dev to QA to prod) or in production (e.g. deploying to different locales with different languages and/or regulatory regimes to support).  To that end, flexible configuration management within deployment definitions should be easily defined and supported.</p>
</dd>
<dt class="hdlist1">Extensible</dt>
<dd>
<p>Kubernetes is very extensible, as the abundance of <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/#custom-resources">Custom Resource Definitions</a> illustrates.  Deployment definitions should be able include all of them easily without requiring new code.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The following tutorial will demonstrate how el-CICD Chart realizes these enhancements.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tutorial">2. Tutorial</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial will demonstrate how the el-CICD Chart can make defining and templating Kubernetes deployment definitions much easier and more readable, as well as directly supporting configuration management.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
All commands used below will refer to <code>kubectl</code>, but if on OpenShift <code>oc</code> will work just as well.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_add_and_update_the_el_cicd_chart_repository">2.1. Add and update the el-CICD Chart repository</h3>
<div class="paragraph">
<p>Add and update the el-CICD Chart repository.  This will pull the chart from the GitHub repository to your local machine for use.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm repo add elcicd-charts \
  https://raw.githubusercontent.com/elcicd/el-CICD-deploy/main/charts/
$ helm repo update</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>"elcicd-charts" has been added to your repositories</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Hang tight while we grab the latest from your chart repositories...
...Successfully got an update from the "elcicd-charts" chart repository
Update Complete. ⎈Happy Helming!⎈</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_el_cicd_chart_templates">2.2. el-CICD Chart Templates</h3>
<div class="sidebarblock">
<div class="content">
<div class="title">Features demonstrated</div>
<div class="ulist">
<ul>
<li>
<p>Defining and deploying with arbitrary el-CICD Chart deployment profiles.</p>
</li>
<li>
<p><code>elCicdDefs-*</code> variable map definitions.</p>
</li>
<li>
<p>Using el-CICD Chart matrices to create copies of the same el-CICD Chart template.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>The el-CICD Chart aims to define basic Kubernetes resources for application deployments out-of-the-box and provide as many reasonable defaults as possible to reduce the amount of boilerplate required by the end user.  The el-CICD Chart also aims to do away with the need to write Helm (Go) templates, and instead adheres to more standard YAML with only minor enhancements.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The example below is purposefully contrived to be purposefully more complicated than necessary.  In this case the Ingress will be communicating with the Service over port 8081, and the Service will forward incoming requests to Apache Web Server container over port 8080.  The next part of the tutorial will make it clear why we are making this more complicated than necessary.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open your favorite file editor, enter the following YAML, and save it as <code>elcicd-demo-1.yaml</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="YAML"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
</pre></td><td class="code"><pre>elCicdTemplates:
- templateName: deployment
  image: registry.redhat.io/rhel8/httpd-24

- templateName: service
  port: 8081
  targetPort: 8080

- templateName: ingress
  host: httpd-$&lt;HELM_RELEASE_NAMESPACE&gt;.apps-crc.testing
  port: 8081
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>All el-CICD Chart templates are defined in a list called <code>elCicdTemplates</code>.</p>
</li>
<li>
<p>By convention, there is a one-to-one relation between el-CICD Chart templates the Kubernetes resources they render.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>deployment for a Kubernetes Deployment</p>
</li>
<li>
<p>service for a Kubernetes Service</p>
</li>
<li>
<p>ingress for a Kubernetes Ingress</p>
</li>
<li>
<p>el-CICD Chart templates are all lower camel case.</p>
</li>
</ol>
</div>
</li>
<li>
<p><em>Helper attributes</em> are el-CICD Chart template top level keys; e.g. some standard el-CICD attributes every template has:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>templatName</code>: the name of the el-CICD Chart template to render.</p>
</li>
<li>
<p><code>objName</code>: maps directly <code>metadata.name</code>.</p>
</li>
<li>
<p><code>template</code>: custom el-CICD template definitions when built-in templates aren&#8217;t used.</p>
</li>
</ol>
</div>
</li>
<li>
<p><code>$&lt;HELM_RELEASE_NAMESPACE&gt;</code> references a built-in el-CICD Chart variable.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>In a Helm template this corresponds to <code>.Release.Namespace</code>.</p>
</li>
<li>
<p>The <code>$&lt;<em>VARIABLE_NAME</em>&gt;</code> syntax is how variables are referenced in el-CICD Chart templates.</p>
</li>
<li>
<p>el-CICD Chart conventions define variables using upper snake case, similar to Shell.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>
Install the <code>elcicd-chart-demo</code> release in the <code>elcicd-chart-demo</code> namespace using the el-CICD Chart:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm upgrade --install --atomic --history-max=0 -n elcicd-chart-demo --create-namespace -f elcicd-demo-1.yaml elcicd-chart-demo elcicd-charts/elcicd-chart</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Release "elcicd-chart-demo" does not exist. Installing it now.
NAME: elcicd-chart-demo
LAST DEPLOYED: Tue Jul 16 16:47:02 2024
NAMESPACE: elcicd-chart-demo
STATUS: deployed
REVISION: 1
TEST SUITE: None</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
View the manifests that generated by el-CICD Chart from the <code>helm upgrade --install</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm get manifest -n elcicd-chart-demo elcicd-chart-demo</code></pre>
</div>
</div>
<details>
<summary class="title"><strong>Output</strong></summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>---
# Source: elcicd-chart/templates/render.yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: elcicd-chart-demo
    helm.sh/chart: elcicd-chart-0.1.0
  name: elcicd-chart-demo
  namespace: elcicd-chart-demo
spec:
  selector:
    elcicd.io/selector: elcicd-chart-demo
  ports:
  - name: elcicd-chart-demo-port
    port: 8081
    targetPort: 8080
    protocol: TCP
# Rendered el-CICD Chart Template -&gt; "service" elcicd-chart-demo
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: elcicd-chart-demo
    helm.sh/chart: elcicd-chart-0.1.0
  name: elcicd-chart-demo
  namespace: elcicd-chart-demo
spec:
  revisionHistoryLimit: 0
  selector:
    matchExpressions:
    - key: elcicd.io/selector
      operator: Exists
    matchLabels:
      elcicd.io/selector: elcicd-chart-demo
  template:
    metadata:
      labels:
        app.kubernetes.io/instance: elcicd-chart-demo
        app.kubernetes.io/managed-by: Helm
        elcicd.io/selector: elcicd-chart-demo
        helm.sh/chart: elcicd-chart-0.1.0
      name: elcicd-chart-demo
      namespace: elcicd-chart-demo
    spec:
      containers:
      - name: elcicd-chart-demo
        image: registry.redhat.io/rhel8/httpd-24
        imagePullPolicy: Always
        ports:
        - name: default-port
          containerPort: 8080
          protocol: TCP
        resources:
          limits: {}
          requests: {}
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
      imagePullSecrets: []
      securityContext:
        runAsNonRoot: true
        seccompProfile:
          type: RuntimeDefault
# Rendered el-CICD Chart Template -&gt; "deployment" elcicd-chart-demo
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.allow-http: "false"
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: elcicd-chart-demo
    helm.sh/chart: elcicd-chart-0.1.0
  name: elcicd-chart-demo
  namespace: elcicd-chart-demo
spec:
  rules:
  - host: httpd-elcicd-chart-demo.apps-crc.testing
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: elcicd-chart-demo
            port:
              number: 8081
  tls:
  - secretName:
# Rendered el-CICD Chart Template -&gt; "ingress" elcicd-chart-demo
---
# Source: elcicd-chart/templates/render.yaml
# Profiles: []</code></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>
View the running <code>elcicd-chart-demo</code> resources in the cluster:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ kubectl get -n elcicd-chart-demo deploy,rs,pod,cm,service,ingress</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>NAME                                READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/elcicd-chart-demo   1/1     1            1           3m29s

NAME                                           DESIRED   CURRENT   READY   AGE
replicaset.apps/elcicd-chart-demo-6c6fd69cb7   1         1         1       3m29s

NAME                                     READY   STATUS    RESTARTS   AGE
pod/elcicd-chart-demo-6c6fd69cb7-xtk5k   1/1     Running   0          3m29s

NAME                                 DATA   AGE
configmap/kube-root-ca.crt           1      72m
configmap/openshift-service-ca.crt   1      72m

NAME                        TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)    AGE
service/elcicd-chart-demo   ClusterIP   10.217.5.104   &lt;none&gt;        8081/TCP   3m29s

NAME                                          CLASS    HOSTS                                      ADDRESS                           PORTS     AGE
ingress.networking.k8s.io/elcicd-chart-demo   &lt;none&gt;   httpd-elcicd-chart-demo.apps-crc.testing   router-default.apps-crc.testing   80, 443   3m29s</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
Get the value of the host from the Ingress, and verify the Apache Web Server is reachable:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ kubectl get ingress -n elcicd-chart-demo --no-headers -o custom-columns=:.spec.rules[*].host</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>httpd-elcicd-chart-demo.apps-crc.testing</code></pre>
</div>
</div>
<div class="paragraph">
<p>Open your browser and go to <a href="https://httpd-elcicd-chart-demo.apps-crc.testing" class="bare">https://httpd-elcicd-chart-demo.apps-crc.testing</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If not using CRC, you&#8217;ll definitely need to run the <code>kubectl get</code> command above.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="sections/general-steps/images/rhel-test-page-screenshot.png" alt="rhel test page screenshot">
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
Uninstall the chart.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm uninstall -n elcicd-chart-demo elcicd-chart-demo</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>release "elcicd-chart-demo" uninstalled</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_compound_el_cicd_chart_templates">2.3. Compound el-CICD Chart Templates</h3>
<div class="sidebarblock">
<div class="content">
<div class="title">Features demonstrated</div>
<div class="ulist">
<ul>
<li>
<p>Defining compound el-CICD Chart templates.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>In <a href="#_el_cicd_chart_templates">el-CICD Chart Templates</a>, we demonstrated how concise and modular el-CICD Chart templates can be when defining deployments.  We will now show how to combine el-CICD Chart templates into single, <em>compound template</em> for even more concise deployment definitions.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<strong>Any el-CICD Chart built-in template can be compounded into a single template definition as long as any overlapping helper attributes refer to the same data.</strong>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create and save the following file, and name it <code>elcicd-demo-2.yaml</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="YAML"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="code"><pre>elCicdTemplates:
- templateNames: [deployment, service, ingress]
  image: registry.redhat.io/rhel8/httpd-24
  host: httpd-$&lt;HELM_RELEASE_NAMESPACE&gt;.apps-crc.testing
  port: 8081
  targetPort: 8080
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Compound templates are listed under the <code>templateNames</code> attribute, versus the <code>templateName</code> for a single attribute.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Since YAML is superset of JSON, we can use JSON list notation if we wish.</p>
</li>
<li>
<p>The <code>templateName</code> attribute is merely a convenience when rendering a single template.</p>
</li>
</ol>
</div>
</li>
<li>
<p>In compound templates, all helper attributes are shared among the el-CICD templates.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>image</code> is unique to the deployment template.</p>
</li>
<li>
<p><code>host</code> is unique to the ingress el-CICD Chart template.</p>
</li>
<li>
<p><code>port</code> is shared and used by all three listed el-CICD Chart templates.</p>
</li>
<li>
<p><code>targetPort</code> is shared by the service and deployment templates, and take precedence over the <code>port</code> attribute when defined.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In <a href="#_el_cicd_chart_templates">el-CICD Chart Templates</a>, we promised to explain why we contrived a different port and target port as a tutorial contrivance, and it was to demonstrate how overlapping helper attributes would behave in compound templates.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>
Install the <code>elcicd-chart-demo</code> release in the <code>elcicd-chart-demo</code> namespace using the el-CICD Chart:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm upgrade --install --atomic --history-max=0 -n elcicd-chart-demo --create-namespace -f elcicd-demo-2.yaml elcicd-chart-demo elcicd-charts/elcicd-chart</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Release "elcicd-chart-demo" does not exist. Installing it now.
NAME: elcicd-chart-demo
LAST DEPLOYED: Tue Jul 16 16:47:02 2024
NAMESPACE: elcicd-chart-demo
STATUS: deployed
REVISION: 1
TEST SUITE: None</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
View the manifests that generated by el-CICD Chart from the <code>helm upgrade --install</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm get manifest -n elcicd-chart-demo elcicd-chart-demo</code></pre>
</div>
</div>
<details>
<summary class="title"><strong>Output</strong></summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>---
# Source: elcicd-chart/templates/render.yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: elcicd-chart-demo
    helm.sh/chart: elcicd-chart-0.1.0
  name: elcicd-chart-demo
  namespace: elcicd-chart-demo
spec:
  selector:
    elcicd.io/selector: elcicd-chart-demo
  ports:
  - name: elcicd-chart-demo-port
    port: 8081
    targetPort: 8080
    protocol: TCP
# Rendered el-CICD Chart Template -&gt; "service" elcicd-chart-demo
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: elcicd-chart-demo
    helm.sh/chart: elcicd-chart-0.1.0
  name: elcicd-chart-demo
  namespace: elcicd-chart-demo
spec:
  revisionHistoryLimit: 0
  selector:
    matchExpressions:
    - key: elcicd.io/selector
      operator: Exists
    matchLabels:
      elcicd.io/selector: elcicd-chart-demo
  template:
    metadata:
      labels:
        app.kubernetes.io/instance: elcicd-chart-demo
        app.kubernetes.io/managed-by: Helm
        elcicd.io/selector: elcicd-chart-demo
        helm.sh/chart: elcicd-chart-0.1.0
      name: elcicd-chart-demo
      namespace: elcicd-chart-demo
    spec:
      containers:
      - name: elcicd-chart-demo
        image: registry.redhat.io/rhel8/httpd-24
        imagePullPolicy: Always
        ports:
        - name: default-port
          containerPort: 8080
          protocol: TCP
        resources:
          limits: {}
          requests: {}
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
      imagePullSecrets: []
      securityContext:
        runAsNonRoot: true
        seccompProfile:
          type: RuntimeDefault
# Rendered el-CICD Chart Template -&gt; "deployment" elcicd-chart-demo
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.allow-http: "false"
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: elcicd-chart-demo
    helm.sh/chart: elcicd-chart-0.1.0
  name: elcicd-chart-demo
  namespace: elcicd-chart-demo
spec:
  rules:
  - host: httpd-elcicd-chart-demo.apps-crc.testing
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: elcicd-chart-demo
            port:
              number: 8081
  tls:
  - secretName:
# Rendered el-CICD Chart Template -&gt; "ingress" elcicd-chart-demo
---
# Source: elcicd-chart/templates/render.yaml
# Profiles: []</code></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>
View the running <code>elcicd-chart-demo</code> resources in the cluster:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ kubectl get -n elcicd-chart-demo deploy,rs,pod,cm,service,ingress</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>NAME                                READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/elcicd-chart-demo   1/1     1            1           4m55s

NAME                                           DESIRED   CURRENT   READY   AGE
replicaset.apps/elcicd-chart-demo-6c6fd69cb7   1         1         1       4m55s

NAME                                     READY   STATUS    RESTARTS   AGE
pod/elcicd-chart-demo-6c6fd69cb7-xtk5k   1/1     Running   0          4m55s

NAME                                 DATA   AGE
configmap/kube-root-ca.crt           1      72m
configmap/openshift-service-ca.crt   1      72m

NAME                        TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)    AGE
service/elcicd-chart-demo   ClusterIP   10.217.5.104   &lt;none&gt;        8081/TCP   4m55s

NAME                                          CLASS    HOSTS                                      ADDRESS                           PORTS     AGE
ingress.networking.k8s.io/elcicd-chart-demo   &lt;none&gt;   httpd-elcicd-chart-demo.apps-crc.testing   router-default.apps-crc.testing   80, 443   4m55s</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
Get the value of the host from the Ingress, and verify the Apache Web Server is reachable:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ kubectl get ingress -n elcicd-chart-demo --no-headers -o custom-columns=:.spec.rules[*].host</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>httpd-elcicd-chart-demo.apps-crc.testing</code></pre>
</div>
</div>
<div class="paragraph">
<p>Open your browser and go to <a href="https://httpd-elcicd-chart-demo.apps-crc.testing" class="bare">https://httpd-elcicd-chart-demo.apps-crc.testing</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If not using CRC, you&#8217;ll definitely need to run the <code>kubectl get</code> command above.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="sections/general-steps/images/rhel-test-page-screenshot.png" alt="rhel test page screenshot">
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
Uninstall the chart.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm uninstall -n elcicd-chart-demo elcicd-chart-demo</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>release "elcicd-chart-demo" uninstalled</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_user_defined_variables">2.4. User-defined Variables</h3>
<div class="sidebarblock">
<div class="content">
<div class="title">Features demonstrated</div>
<div class="ulist">
<ul>
<li>
<p>Defining arbitrary el-CICD Chart variables in deployment definitions.</p>
</li>
<li>
<p>Using el-CICD Chart variables as templates for other values or even scripts.</p>
</li>
<li>
<p>Easily mounting ConfigMaps with the projectedVolumes helper attribute.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Both <a href="#_el_cicd_chart_templates">el-CICD Chart Templates</a> and <a href="#_compound_el_cicd_chart_templates">Compound el-CICD Chart Templates</a> made use of el-CICD Chart&#8217;s built-in variables to help define their host domain.  This part of the tutorial will focus on user-defined variables.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create and save the following file and name it <code>elcicd-demo-3.yaml</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="YAML"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="code"><pre>elCicdDefs:
  INDEX_HTML_NAME: index.html
  DEFAULT_PAGE_CONTENT: &lt;h1&gt;Howdy from $&lt;OBJ_NAME&gt; in release $&lt;HELM_RELEASE_NAME&gt;!&lt;h1&gt;
  PAGE_CONTENT: $&lt;DEFAULT_PAGE_CONTENT&gt;
  HTML_PAGE: &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;$&lt;PAGE_CONTENT&gt;&lt;/body&gt;&lt;/html&gt;

  INDEX_HTML_NAME: index.html
  PAGE_CONTENT: &lt;h1&gt;Howdy from $&lt;OBJ_NAME&gt; in release $&lt;HELM_RELEASE_NAME&gt;!&lt;h1&gt;
  HTML_PAGE: |-
    &lt;!DOCTYPE html&gt;
    &lt;html&gt;
      &lt;body&gt;
        &lt;h1&gt;$&lt;PAGE_CONTENT&gt;&lt;/h1&gt;
      &lt;/body&gt;
    &lt;/html&gt;

elCicdTemplates:
- templateNames: [deployment, service, ingress]
  image: registry.redhat.io/rhel8/httpd-24
  host: httpd-$&lt;NAME_SPACE&gt;.apps-crc.testing
  projectedVolumes:
  - name: $&lt;HELM_RELEASE_NAME&gt;
    mountPath: /var/www/html/
    configMaps:
      $&lt;INDEX_HTML_NAME&gt;: {}

- templateName: configMap
  objName: $&lt;INDEX_HTML_NAME&gt;
  data:
    $&lt;OBJ_NAME&gt;: $&lt;HTML_PAGE&gt;
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>All el-CICD Chart variables are defined under maps starting with <code>elCicdDefs</code>.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Keys in the <code>elCicdDefs</code> map are the names of the variables.</p>
</li>
<li>
<p>By convention and similar to shell scripting, variable names are ALL CAPS snake case.</p>
</li>
<li>
<p>Defining variables and their can be any valid YAML.</p>
</li>
<li>
<p>Variables are referenced using the syntax <code>$&lt;VARIABLE_NAME&gt;</code>.</p>
</li>
<li>
<p>Variables values can reference other variables.</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>The order variables are declared is irrelevant.</p>
</li>
<li>
<p>Variable names can be dynamically generated</p>
<div class="olist upperroman">
<ol class="upperroman" type="I">
<li>
<p><code>$&lt;HELM_RELEASE_NAME&gt;</code> is another built-in el-CICD Chart variable that corresponds to <code>.Release.Name</code> in a Helm template.</p>
</li>
<li>
<p>$&lt;HELM_RELEASE_NAME&gt;_foo: some-value` will generate a new value derived from the name of the release.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p><code>projectedVolumes</code> is a helper attribute for generating <a href="https://kubernetes.io/docs/concepts/storage/projected-volumes/">projectedVolumes</a>.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>In this example it will generate a <code>volume</code> entry for ConfigMap in the Deployment.</p>
</li>
<li>
<p>It will also create a volumeMount of the <code>volume</code> on the container at the given <code>mountPath</code>.</p>
</li>
<li>
<p>Per the projectedVolume standard, any number of ConfigMaps, Secrets, etc., can be listed.</p>
</li>
</ol>
</div>
</li>
<li>
<p><code>objName</code> is a helper attribute that will render as the name of a resource or resources; i.e.<code>metadata.name</code>.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>$&lt;OBJ_NAME&gt;</code> is another built-in el-CICD Chart variable referring to the el-CICD Chart template&#8217;s objName in which it is realized.</p>
</li>
<li>
<p><code>objName</code> and <code>OBJ_NAME</code> will default to the chart&#8217;s release name, <code>HELM_RELEASE_NAME</code>, if left undefined by the user.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><br></p>
</div>
</li>
<li>
<p>
Install the <code>elcicd-chart-demo</code> release in the <code>elcicd-chart-demo</code> namespace using the el-CICD Chart:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm upgrade --install --atomic --history-max=0 -n elcicd-chart-demo --create-namespace -f elcicd-demo-3.yaml elcicd-chart-demo elcicd-charts/elcicd-chart</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Release "elcicd-chart-demo" does not exist. Installing it now.
NAME: elcicd-chart-demo
LAST DEPLOYED: Tue Jul 16 16:47:02 2024
NAMESPACE: elcicd-chart-demo
STATUS: deployed
REVISION: 1
TEST SUITE: None</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
View the manifests that generated by el-CICD Chart from the <code>helm upgrade --install</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm get manifest -n elcicd-chart-demo elcicd-chart-demo</code></pre>
</div>
</div>
<details>
<summary class="title"><strong>Output</strong></summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>---
# Source: elcicd-chart/templates/render.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: index.html
    helm.sh/chart: elcicd-chart-0.1.0
  name: index.html
  namespace: elcicd-chart-demo
data:
  index.html: |-
    &lt;!DOCTYPE html&gt;
    &lt;html&gt;
      &lt;body&gt;
        &lt;h1&gt;&lt;h1&gt;Howdy from index.html in release elcicd-chart-demo!&lt;h1&gt;&lt;/h1&gt;
      &lt;/body&gt;
    &lt;/html&gt;
# Rendered el-CICD Chart Template -&gt; "configMap" index.html
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: elcicd-chart-demo
    helm.sh/chart: elcicd-chart-0.1.0
  name: elcicd-chart-demo
  namespace: elcicd-chart-demo
spec:
  selector:
    elcicd.io/selector: elcicd-chart-demo
  ports:
  - name: elcicd-chart-demo-port
    port: 8080
    protocol: TCP
# Rendered el-CICD Chart Template -&gt; "service" elcicd-chart-demo
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: elcicd-chart-demo
    helm.sh/chart: elcicd-chart-0.1.0
  name: elcicd-chart-demo
  namespace: elcicd-chart-demo
spec:
  revisionHistoryLimit: 0
  selector:
    matchExpressions:
    - key: elcicd.io/selector
      operator: Exists
    matchLabels:
      elcicd.io/selector: elcicd-chart-demo
  template:
    metadata:
      labels:
        app.kubernetes.io/instance: elcicd-chart-demo
        app.kubernetes.io/managed-by: Helm
        elcicd.io/selector: elcicd-chart-demo
        helm.sh/chart: elcicd-chart-0.1.0
      name: elcicd-chart-demo
      namespace: elcicd-chart-demo
    spec:
      containers:
      - name: elcicd-chart-demo
        image: registry.redhat.io/rhel8/httpd-24
        imagePullPolicy: Always
        ports:
        - name: default-port
          containerPort: 8080
          protocol: TCP
        resources:
          limits: {}
          requests: {}
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
        volumeMounts:
        - mountPath: /var/www/html/
          name: elcicd-chart-demo
          readOnly: false
      imagePullSecrets: []
      securityContext:
        runAsNonRoot: true
        seccompProfile:
          type: RuntimeDefault
      volumes:
      - name: elcicd-chart-demo
        projected:
          sources:
          - configMap:
              name: index.html
# Rendered el-CICD Chart Template -&gt; "deployment" elcicd-chart-demo
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.allow-http: "false"
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: elcicd-chart-demo
    helm.sh/chart: elcicd-chart-0.1.0
  name: elcicd-chart-demo
  namespace: elcicd-chart-demo
spec:
  rules:
  - host: httpd-elcicd-chart-demo.apps-crc.testing
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: elcicd-chart-demo
            port:
              number: 8080
  tls:
  - secretName:
# Rendered el-CICD Chart Template -&gt; "ingress" elcicd-chart-demo
---
# Source: elcicd-chart/templates/render.yaml
# Profiles: []</code></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>
View the running <code>elcicd-chart-demo</code> resources in the cluster:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ kubectl get -n elcicd-chart-demo deploy,rs,pod,cm,service,ingress</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>NAME                                READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/elcicd-chart-demo   1/1     1            1           3m17s

NAME                                          DESIRED   CURRENT   READY   AGE
replicaset.apps/elcicd-chart-demo-878f4b9d5   1         1         1       3m17s

NAME                                    READY   STATUS    RESTARTS   AGE
pod/elcicd-chart-demo-878f4b9d5-x88mg   1/1     Running   0          3m17s

NAME                                 DATA   AGE
configmap/index.html                 1      3m17s
configmap/kube-root-ca.crt           1      171m
configmap/openshift-service-ca.crt   1      171m

NAME                        TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)    AGE
service/elcicd-chart-demo   ClusterIP   10.217.5.87   &lt;none&gt;        8080/TCP   3m17s

NAME                                          CLASS    HOSTS                                      ADDRESS                           PORTS     AGE
ingress.networking.k8s.io/elcicd-chart-demo   &lt;none&gt;   httpd-elcicd-chart-demo.apps-crc.testing   router-default.apps-crc.testing   80, 443   3m17s</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
Get the value of the host from the Ingress, and verify the Apache Web Server is reachable:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ kubectl get ingress -n elcicd-chart-demo --no-headers -o custom-columns=:.spec.rules[*].host</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>httpd-elcicd-chart-demo.apps-crc.testing</code></pre>
</div>
</div>
<div class="paragraph">
<p>Open your browser and go to <a href="https://httpd-elcicd-chart-demo.apps-crc.testing" class="bare">https://httpd-elcicd-chart-demo.apps-crc.testing</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If not using CRC, you&#8217;ll definitely need to run the <code>kubectl get</code> command above.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="sections/general-steps/images/user-defined-variables-screenshot.png" alt="user defined variables screenshot">
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
Uninstall the chart.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm uninstall -n elcicd-chart-demo elcicd-chart-demo</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>release "elcicd-chart-demo" uninstalled</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_deployment_profiles">2.5. Deployment Profiles</h3>
<div class="sidebarblock">
<div class="content">
<div class="title">Features demonstrated</div>
<div class="ulist">
<ul>
<li>
<p>Defining and deploying with arbitrary el-CICD Chart deployment profiles.</p>
</li>
<li>
<p><code>elCicdDefs-*</code> variable map definitions.</p>
</li>
<li>
<p>Using el-CICD Chart matrices to create copies of the same el-CICD Chart template.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>In <a href="#_user_defined_variables">User-defined Variables</a>, we demonstrated how to define and reference your own variables in your deployment definitions. In this part of the tutorial you&#8217;ll learn about deployment profiles.  While the previous parts of the tutorial have focused on el-CICD Chart&#8217;s strengths with regards to templating, readability, and conciseness, it&#8217;s the deployment profiles that give el-CICD Chart its power.  This feature makes it much, much easier for users to manage a deployment definition across numerous environments with minimal configuration, because whole swaths of variable definitions and templates can be configured with under a single profile.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Example use cases for deployment profiles</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/Software_development_process">SDLC</a></p>
<div class="paragraph">
<p>Development ,test, and production environments almost always vary, large and small, in how they&#8217;re configured for deployment.</p>
</div>
</li>
<li>
<p>Different locales</p>
<div class="paragraph">
<p>Different nations, and most nations with provinces or states, tend to have different regulatory and/or language requirements between them.</p>
</div>
</li>
<li>
<p>High availability and persistence options</p>
<div class="paragraph">
<p>A particular component may or may not need to be deployed as highly available and/or with data persistence options.  A separate profile for each that could be mixed and matched would appropriate in this case.</p>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Deployment profiles are most useful whenever any significant amount of data/or and configuration within a deployment needs to change in unison based on a single deployment.</p>
</div>
<div class="paragraph">
<p>The part of the tutorial will demonstrate deploying a default English and a multi-lingual deployment of our contrived web application.</p>
</div>
<div class="sect3">
<h4 id="_create_the_deployment_definition_with_two_deployment_profiles">2.5.1. Create the deployment definition with two deployment profiles</h4>
<div class="paragraph">
<p>Create and save the following file, and name it <code>elcicd-demo-4.yaml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="YAML">elCicdDefs:
  MULTI_LINGUAL_PROFILE: multi-lingual
  INDEX_HTML_NAME: index.html
  DEFAULT_PAGE_CONTENT: &lt;h1&gt;Howdy from $&lt;OBJ_NAME&gt; in release $&lt;HELM_RELEASE_NAME&gt;!&lt;h1&gt;
  PAGE_CONTENT: $&lt;DEFAULT_PAGE_CONTENT&gt;
  HTML_PAGE: &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;$&lt;PAGE_CONTENT&gt;&lt;/body&gt;&lt;/html&gt;

elCicdDefs-$&lt;MULTI_LINGUAL_PROFILE&gt;: # <b class="conum">(1)</b>
  PAGE_CONTENT: &lt;h1&gt;&lt;a href="$&lt;ENGLISH&gt;"&gt;English&lt;/a&gt;&amp;nbsp;&lt;a href="$&lt;ESPANOL&gt;"&gt;Español&lt;/a&gt;&lt;/h1&gt;
  ENGLISH: english.html
  ESPANOL: espanol.html

elCicdTemplates:
- templateNames: [deployment, service, ingress]
  image: registry.redhat.io/rhel8/httpd-24
  host: httpd-$&lt;NAME_SPACE&gt;.apps-crc.testing
  projectedVolumes:
  - name: $&lt;HELM_RELEASE_NAME&gt;
    mountPath: /var/www/html/
    configMaps:
      $&lt;INDEX_HTML_NAME&gt;: {}
      $&lt;ENGLISH&gt;: {}
      $&lt;ESPANOL&gt;: {}

- templateName: configMap
  objName: $&lt;INDEX_HTML_NAME&gt;
  data:
    $&lt;OBJ_NAME&gt;: $&lt;HTML_PAGE&gt;

- templateName: configMap
  objNames: # <b class="conum">(3)</b>
  - $&lt;ENGLISH&gt;
  - $&lt;ESPANOL&gt;
  mustHaveAnyProfile:
  - $&lt;MULTI_LINGUAL_PROFILE&gt; # <b class="conum">(1)</b>
  elCicdDefs-$&lt;ENGLISH&gt;: # <b class="conum">(2)</b>
    PAGE_CONTENT:  $&lt;DEFAULT_PAGE_CONTENT&gt;
  elCicdDefs-$&lt;ESPANOL&gt;: # <b class="conum">(2)</b>
    PAGE_CONTENT: &lt;h1&gt;¡Hola desde $&lt;OBJ_NAME&gt; en el lanzamiento $&lt;HELM_RELEASE_NAME&gt;!&lt;h1&gt;
  data:
    $&lt;OBJ_NAME&gt;: $&lt;HTML_PAGE&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Deployment profiles are declared whenever an el-CICD Chart template and/or <code>elCicdDefs</code> variable map is marked for them.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>elCicdDefs-$&lt;MULTI_LINGUAL_PROFILE&gt;</code> declares the <code>$&lt;MULTI_LINGUAL_PROFILE&gt;</code> (<code>multi-lingual</code>) profile.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Variables defined under this map will only be realized when the <code>multi-lingual</code> profile is active.</p>
</li>
<li>
<p><code>elCicdDefs</code> maps may only reference one profile at a time.</p>
</li>
</ol>
</div>
</li>
<li>
<p><code>mustHaveAnyProfile</code> similarly declares the <code>$&lt;MULTI_LINGUAL_PROFILE&gt;</code> (<code>multi-lingual</code>) profile.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The <code>[$&lt;ENGLISH&gt;, $&lt;ESPANOL&gt;]</code> configMap template will only be processed when the <code>multi-lingual</code> profile is active.</p>
</li>
<li>
<p>The full list of template discriminators is</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p><code>mustHaveAnyProfile</code></p>
</li>
<li>
<p><code>mustHaveEveryProfile</code></p>
</li>
<li>
<p><code>mustNotHaveAnyProfile</code></p>
</li>
<li>
<p><code>mustNotHaveEveryProfile</code></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>el-Cicd Chart variables are overridden based on more specific <code>elCicdDefs</code> variable maps.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>elCicdDefs</code> variable maps can be declared for specific profiles, a particular <code>objName</code>, and/or specific templates.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Append an objName and/or profile to and <code>elCicdDefs</code> map declaration using snake case.</p>
</li>
<li>
<p><code>objName</code> must precede the profile.</p>
</li>
<li>
<p>e.g. <code>elCicdDefs-&lt;some objName&gt;-&lt;some profile&gt;</code>.  `obj</p>
</li>
<li>
<p>Variable references in lieu of static declarations, e.g. elCicdDefs-$&lt;MULTI_LINGUAL_PROFILE&gt;.</p>
<div class="paragraph">
<p>If a variable map name ends with <code>-</code> (e.g. <code>elCicdDefs-</code>) because a variable in the name was undefined, the map will be ignored.</p>
</div>
</li>
<li>
<p>Order of precedence for variable value assignment, from least to greatest.  This list applies at the top-level first, and then per template.</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p><code>elCicdDefs</code></p>
</li>
<li>
<p><code>elCicdDefs-&lt;<em>profile-name</em>&gt;</code>: variables defined for a specific active profile.</p>
</li>
<li>
<p><code>elCicdDefs-&lt;<em>objName</em>&gt;</code>: variables defined for a specific el-CICD Chart template.</p>
</li>
<li>
<p><code>elCicdDefs-&lt;<em>objName</em>&gt;-&lt;<em>profile-name</em>&gt;</code>: variables defined for el-CICD Chart template and specific profile.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p><code>objNames</code> is one of two el-CICD Chart matrices that can be defined on an el-CICD Chart template.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Matrices are lists that generate a copy of the template for each element in the list.</p>
</li>
<li>
<p><code>objName</code> will be assigned for each copy corresponding to an element in the <code>objNames</code> list used to generate it.</p>
</li>
<li>
<p>This deployment definition will result in two configMap templates, <code>$&lt;ENGLISH&gt;</code> (<code>english.html) and `$&lt;ESPANOL&gt;</code> (<code>espanol.html</code>).</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_deploy_the_httpd_server_without_an_active_deployment_profile">2.5.2. Deploy the httpd server without an active deployment profile</h4>
<div class="paragraph">
<p>These steps will have results that look identical to the <a href="#_user_defined_variables">User-defined Variables</a> demonstration in every way.  The lack of a proper active profile in this deployment means all the additions made to the deployment definition in elcicd-demo-4.yaml will be ignored.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>
Install the <code>elcicd-chart-demo</code> release in the <code>elcicd-chart-demo</code> namespace using the el-CICD Chart:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm upgrade --install --atomic --history-max=0 -n elcicd-chart-demo --create-namespace -f elcicd-demo-4.yaml elcicd-chart-demo elcicd-charts/elcicd-chart</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Release "elcicd-chart-demo" does not exist. Installing it now.
NAME: elcicd-chart-demo
LAST DEPLOYED: Tue Jul 16 16:47:02 2024
NAMESPACE: elcicd-chart-demo
STATUS: deployed
REVISION: 1
TEST SUITE: None</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
View the manifests that generated by el-CICD Chart from the <code>helm upgrade --install</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm get manifest -n elcicd-chart-demo elcicd-chart-demo</code></pre>
</div>
</div>
<details>
<summary class="title"><strong>Output</strong></summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>---
# Source: elcicd-chart/templates/render.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: index.html
    helm.sh/chart: elcicd-chart-0.1.0
  name: index.html
  namespace: elcicd-chart-demo
data:
  index.html: &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Howdy from index.html in release elcicd-chart-demo!&lt;h1&gt;&lt;/body&gt;&lt;/html&gt;
# Rendered el-CICD Chart Template -&gt; "configMap" index.html
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: elcicd-chart-demo
    helm.sh/chart: elcicd-chart-0.1.0
  name: elcicd-chart-demo
  namespace: elcicd-chart-demo
spec:
  selector:
    elcicd.io/selector: elcicd-chart-demo
  ports:
  - name: elcicd-chart-demo-port
    port: 8080
    protocol: TCP
# Rendered el-CICD Chart Template -&gt; "service" elcicd-chart-demo
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: elcicd-chart-demo
    helm.sh/chart: elcicd-chart-0.1.0
  name: elcicd-chart-demo
  namespace: elcicd-chart-demo
spec:
  revisionHistoryLimit: 0
  selector:
    matchExpressions:
    - key: elcicd.io/selector
      operator: Exists
    matchLabels:
      elcicd.io/selector: elcicd-chart-demo
  template:
    metadata:
      labels:
        app.kubernetes.io/instance: elcicd-chart-demo
        app.kubernetes.io/managed-by: Helm
        elcicd.io/selector: elcicd-chart-demo
        helm.sh/chart: elcicd-chart-0.1.0
      name: elcicd-chart-demo
      namespace: elcicd-chart-demo
    spec:
      containers:
      - name: elcicd-chart-demo
        image: registry.redhat.io/rhel8/httpd-24
        imagePullPolicy: Always
        ports:
        - name: default-port
          containerPort: 8080
          protocol: TCP
        resources:
          limits: {}
          requests: {}
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
        volumeMounts:
        - mountPath: /var/www/html/
          name: elcicd-chart-demo
          readOnly: false
      imagePullSecrets: []
      securityContext:
        runAsNonRoot: true
        seccompProfile:
          type: RuntimeDefault
      volumes:
      - name: elcicd-chart-demo
        projected:
          sources:
          - configMap:
              name: index.html
# Rendered el-CICD Chart Template -&gt; "deployment" elcicd-chart-demo
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.allow-http: "false"
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: elcicd-chart-demo
    helm.sh/chart: elcicd-chart-0.1.0
  name: elcicd-chart-demo
  namespace: elcicd-chart-demo
spec:
  rules:
  - host: httpd-elcicd-chart-demo.apps-crc.testing
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: elcicd-chart-demo
            port:
              number: 8080
  tls:
  - secretName:
# Rendered el-CICD Chart Template -&gt; "ingress" elcicd-chart-demo
---
# Source: elcicd-chart/templates/render.yaml
# Profiles: []
# EXCLUDED BY PROFILES: configMap -&gt; objNames: [$&lt;ENGLISH&gt; $&lt;ESPANOL&gt;]</code></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>
View the running <code>elcicd-chart-demo</code> resources in the cluster:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ kubectl get -n elcicd-chart-demo deploy,rs,pod,cm,service,ingress</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>NAME                                READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/elcicd-chart-demo   1/1     1            1           3m49s

NAME                                          DESIRED   CURRENT   READY   AGE
replicaset.apps/elcicd-chart-demo-878f4b9d5   1         1         1       3m49s

NAME                                    READY   STATUS    RESTARTS   AGE
pod/elcicd-chart-demo-878f4b9d5-ng28g   1/1     Running   0          3m49s

NAME                                 DATA   AGE
configmap/index.html                 1      3m49s
configmap/kube-root-ca.crt           1      2d
configmap/openshift-service-ca.crt   1      2d

NAME                        TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)    AGE
service/elcicd-chart-demo   ClusterIP   10.217.5.142   &lt;none&gt;        8080/TCP   3m49s

NAME                                          CLASS    HOSTS                                      ADDRESS                           PORTS     AGE
ingress.networking.k8s.io/elcicd-chart-demo   &lt;none&gt;   httpd-elcicd-chart-demo.apps-crc.testing   router-default.apps-crc.testing   80, 443   3m49s</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
Get the value of the host from the Ingress, and verify the Apache Web Server is reachable:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ kubectl get ingress -n elcicd-chart-demo --no-headers -o custom-columns=:.spec.rules[*].host</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>httpd-elcicd-chart-demo.apps-crc.testing</code></pre>
</div>
</div>
<div class="paragraph">
<p>Open your browser and go to <a href="https://httpd-elcicd-chart-demo.apps-crc.testing" class="bare">https://httpd-elcicd-chart-demo.apps-crc.testing</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If not using CRC, you&#8217;ll definitely need to run the <code>kubectl get</code> command above.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="sections/general-steps/images/deployment-profiles-default-screenshot.png" alt="deployment profiles default screenshot">
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
Uninstall the chart.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm uninstall -n elcicd-chart-demo elcicd-chart-demo</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>release "elcicd-chart-demo" uninstalled</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_install_the_httpd_server_with_the_multi_lingual_deployment_profile">2.5.3. Install the httpd server with the <code>multi-lingual</code> deployment profile</h4>
<div class="paragraph">
<p>el-CICD Chart deployment profiles are defined in <code>elCicdProfiles</code> as a list.  It only makes sense to define the active profile list outside of the deployment definition and at deployment time, or that would defeat their purpose.  The <code>helm update --install</code> command is modified to apply deployment profile <code>--set elCicdProfiles='{multi-lingual}'</code> clause.  If more than one deployment profile is specified, the order of precedence from least to greatest in determining the values of variables; e.g. if <code>elCicdProfiles={foo,bar}</code>, all values defined in the <code>bar</code> profile would take precedence over <code>foo</code>.</p>
</div>
<div class="paragraph">
<p>This part of the demonstration will change the opening page to a pair of links that will take you to either English or Spanish versions of the "Howdy!" message.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>
Install the <code>elcicd-chart-demo</code> release in the <code>elcicd-chart-demo</code> namespace using the el-CICD Chart:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm upgrade --install --atomic --history-max=0 -n elcicd-chart-demo --create-namespace --set elCicdProfiles='{multi-lingual}' -f elcicd-demo-4.yaml elcicd-chart-demo elcicd-charts/elcicd-chart</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Release "elcicd-chart-demo" does not exist. Installing it now.
NAME: elcicd-chart-demo
LAST DEPLOYED: Tue Jul 16 16:47:02 2024
NAMESPACE: elcicd-chart-demo
STATUS: deployed
REVISION: 1
TEST SUITE: None</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
View the manifests that generated by el-CICD Chart from the <code>helm upgrade --install</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm get manifest -n elcicd-chart-demo elcicd-chart-demo</code></pre>
</div>
</div>
<details>
<summary class="title"><strong>Output</strong></summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>---
# Source: elcicd-chart/templates/render.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: index.html
    helm.sh/chart: elcicd-chart-0.1.0
  name: index.html
  namespace: elcicd-chart-demo
data:
  index.html: &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;h1&gt;&lt;a href="english.html"&gt;English&lt;/a&gt;&amp;nbsp;&lt;a
    href="espanol.html"&gt;Español&lt;/a&gt;&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;
# Rendered el-CICD Chart Template -&gt; "configMap" index.html
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: english.html
    helm.sh/chart: elcicd-chart-0.1.0
  name: english.html
  namespace: elcicd-chart-demo
data:
  english.html: &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Howdy from english.html in release elcicd-chart-demo!&lt;h1&gt;&lt;/body&gt;&lt;/html&gt;
# Rendered el-CICD Chart Template -&gt; "configMap" english.html
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: espanol.html
    helm.sh/chart: elcicd-chart-0.1.0
  name: espanol.html
  namespace: elcicd-chart-demo
data:
  espanol.html: &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;h1&gt;¡Hola desde espanol.html en el lanzamiento
    elcicd-chart-demo!&lt;h1&gt;&lt;/body&gt;&lt;/html&gt;
# Rendered el-CICD Chart Template -&gt; "configMap" espanol.html
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: elcicd-chart-demo
    helm.sh/chart: elcicd-chart-0.1.0
  name: elcicd-chart-demo
  namespace: elcicd-chart-demo
spec:
  selector:
    elcicd.io/selector: elcicd-chart-demo
  ports:
  - name: elcicd-chart-demo-port
    port: 8080
    protocol: TCP
# Rendered el-CICD Chart Template -&gt; "service" elcicd-chart-demo
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: elcicd-chart-demo
    helm.sh/chart: elcicd-chart-0.1.0
  name: elcicd-chart-demo
  namespace: elcicd-chart-demo
spec:
  revisionHistoryLimit: 0
  selector:
    matchExpressions:
    - key: elcicd.io/selector
      operator: Exists
    matchLabels:
      elcicd.io/selector: elcicd-chart-demo
  template:
    metadata:
      labels:
        app.kubernetes.io/instance: elcicd-chart-demo
        app.kubernetes.io/managed-by: Helm
        elcicd.io/selector: elcicd-chart-demo
        helm.sh/chart: elcicd-chart-0.1.0
      name: elcicd-chart-demo
      namespace: elcicd-chart-demo
    spec:
      containers:
      - name: elcicd-chart-demo
        image: registry.redhat.io/rhel8/httpd-24
        imagePullPolicy: Always
        ports:
        - name: default-port
          containerPort: 8080
          protocol: TCP
        resources:
          limits: {}
          requests: {}
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
        volumeMounts:
        - mountPath: /var/www/html/
          name: elcicd-chart-demo
          readOnly: false
      imagePullSecrets: []
      securityContext:
        runAsNonRoot: true
        seccompProfile:
          type: RuntimeDefault
      volumes:
      - name: elcicd-chart-demo
        projected:
          sources:
          - configMap:
              name: english.html
          - configMap:
              name: espanol.html
          - configMap:
              name: index.html
# Rendered el-CICD Chart Template -&gt; "deployment" elcicd-chart-demo
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.allow-http: "false"
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: elcicd-chart-demo
    helm.sh/chart: elcicd-chart-0.1.0
  name: elcicd-chart-demo
  namespace: elcicd-chart-demo
spec:
  rules:
  - host: httpd-elcicd-chart-demo.apps-crc.testing
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: elcicd-chart-demo
            port:
              number: 8080
  tls:
  - secretName:
# Rendered el-CICD Chart Template -&gt; "ingress" elcicd-chart-demo
---
# Source: elcicd-chart/templates/render.yaml
# Profiles: [multi-lingual]</code></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>
View the running <code>elcicd-chart-demo</code> resources in the cluster:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ kubectl get -n elcicd-chart-demo deploy,rs,pod,cm,service,ingress</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>NAME                                READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/elcicd-chart-demo   1/1     1            1           5m23s

NAME                                           DESIRED   CURRENT   READY   AGE
replicaset.apps/elcicd-chart-demo-58494f8c55   1         1         1       5m23s

NAME                                     READY   STATUS    RESTARTS   AGE
pod/elcicd-chart-demo-58494f8c55-5tp6x   1/1     Running   0          5m23s

NAME                                 DATA   AGE
configmap/english.html               1      5m23s
configmap/espanol.html               1      5m23s
configmap/index.html                 1      5m23s
configmap/kube-root-ca.crt           1      2d1h
configmap/openshift-service-ca.crt   1      2d1h

NAME                        TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)    AGE
service/elcicd-chart-demo   ClusterIP   10.217.5.97   &lt;none&gt;        8080/TCP   5m23s

NAME                                          CLASS    HOSTS                                      ADDRESS                           PORTS     AGE
ingress.networking.k8s.io/elcicd-chart-demo   &lt;none&gt;   httpd-elcicd-chart-demo.apps-crc.testing   router-default.apps-crc.testing   80, 443   5m23s</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
Get the value of the host from the Ingress, and verify the Apache Web Server is reachable:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ kubectl get ingress -n elcicd-chart-demo --no-headers -o custom-columns=:.spec.rules[*].host</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>httpd-elcicd-chart-demo.apps-crc.testing</code></pre>
</div>
</div>
<div class="paragraph">
<p>Open your browser and go to <a href="https://httpd-elcicd-chart-demo.apps-crc.testing" class="bare">https://httpd-elcicd-chart-demo.apps-crc.testing</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If not using CRC, you&#8217;ll definitely need to run the <code>kubectl get</code> command above.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="sections/general-steps/images/deployment-profiles-multi-lingual-screenshot.png" alt="deployment profiles multi lingual screenshot">
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
Uninstall the chart.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm uninstall -n elcicd-chart-demo elcicd-chart-demo</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>release "elcicd-chart-demo" uninstalled</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_free_form_templates">2.6. Free Form Templates</h3>
<div class="sidebarblock">
<div class="content">
<div class="title">Features demonstrated</div>
<div class="ulist">
<ul>
<li>
<p>Defining and deploying with arbitrary el-CICD Chart deployment profiles.</p>
</li>
<li>
<p><code>elCicdDefs-*</code> variable map definitions.</p>
</li>
<li>
<p>Using el-CICD Chart matrices to create copies of the same el-CICD Chart template.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>So far this tutorial has focused on the easy deployments for applications using built-in helper el-CICD Chart templates.  Unfortunately, Kubernetes has many dozens of resources, and it is infinitely extensible with <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/#custom-resources">Custom Resource Definitions</a>, so creating helper templates for every resource for every possible Kubernetes resource that can be deployed is not really feasible.</p>
</div>
<div class="paragraph">
<p>To address this, el-CICD Chart templates allow for the complete definition of resources.  Rather than using a named helper template with <code>templateName(s)</code>, instead the full YAML of the resource is written under the <code>template</code> key.  While more verbose than their helper template counterparts, they still allow for the use of el-CICD Chart variables, deployment profiles, and matrices, and they are still simpler to define than their Helm template counterparts.</p>
</div>
<div class="paragraph">
<p>For this part of the tutorial, we will mix raw templates with helper templates using the same chart definition we deployed in first part of the tutorial.  In order to further demonstrate how free form templates integrate easily into the larger el-CICD Chart, we&#8217;ll deploy two httpd servers.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create and save the following file, and name it <code>elcicd-demo-4.yaml</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="YAML"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="code"><pre>. elCicdDefs:
.   OBJ_NAMES:
.   - httpd-server
  - httpd-server-es
  NAMESPACES:
  - elcicd-chart-demo
  - elcicd-chart-demo-es

elCicdTemplates:
- templateName: namespace
  objNames: $&lt;NAMESPACES&gt;

- templateName: configMap
  objNames: $&lt;OBJ_NAMES&gt;
  data:
    $&lt;INDEX_HTML_NAME&gt;: $&lt;HTML_PAGE&gt;

- objNames: $&lt;OBJ_NAMES&gt;
  template:
    apiVersion: batch/v1
    kind: Job
    metadata:
      name: pi
    spec:
      template:
        spec:
          containers:
          - name: pi
            image: perl:5.34.0
            command: ["perl",  "-Mbignum=bpi", "-wle", "print bpi(2000)"]
          restartPolicy: Never
      backoffLimit: 4
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
</li>
<li>
<p>
Install the <code>elcicd-chart-demo</code> release in the <code>elcicd-chart-demo</code> namespace using the el-CICD Chart:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm upgrade --install --atomic --history-max=0 -n elcicd-chart-demo --create-namespace -f elcicd-demo-5.yaml elcicd-chart-demo elcicd-charts/elcicd-chart</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Release "elcicd-chart-demo" does not exist. Installing it now.
NAME: elcicd-chart-demo
LAST DEPLOYED: Tue Jul 16 16:47:02 2024
NAMESPACE: elcicd-chart-demo
STATUS: deployed
REVISION: 1
TEST SUITE: None</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>
View the manifests that generated by el-CICD Chart from the <code>helm upgrade --install</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm get manifest -n elcicd-chart-demo elcicd-chart-demo</code></pre>
</div>
</div>
<details>
<summary class="title"><strong>Output</strong></summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>---
# Source: elcicd-chart/templates/render.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: server-1
    helm.sh/chart: elcicd-chart-0.1.0
  name: server-1
  namespace: elcicd-chart-demo
data:
  index.html: |-
    &lt;!DOCTYPE html&gt;
    &lt;html&gt;
      &lt;body&gt;
        &lt;h1&gt;&lt;h1&gt;Howdy from server-1 in release elcicd-chart-demo!&lt;h1&gt;&lt;/h1&gt;
      &lt;/body&gt;
    &lt;/html&gt;
# Rendered el-CICD Chart Template -&gt; "configMap" server-1
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: server-2
    helm.sh/chart: elcicd-chart-0.1.0
  name: server-2
  namespace: elcicd-chart-demo
data:
  index.html: |-
    &lt;!DOCTYPE html&gt;
    &lt;html&gt;
      &lt;body&gt;
        &lt;h1&gt;&lt;h1&gt;Howdy from server-2 in release elcicd-chart-demo!&lt;h1&gt;&lt;/h1&gt;
      &lt;/body&gt;
    &lt;/html&gt;
# Rendered el-CICD Chart Template -&gt; "configMap" server-2
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: server-1
    helm.sh/chart: elcicd-chart-0.1.0
  name: server-1
  namespace: elcicd-chart-demo
spec:
  selector:
    elcicd.io/selector: server-1
  ports:
  - name: server-1-port
    port: 8080
    protocol: TCP
# Rendered el-CICD Chart Template -&gt; "service" server-1
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: server-2
    helm.sh/chart: elcicd-chart-0.1.0
  name: server-2
  namespace: elcicd-chart-demo
spec:
  selector:
    elcicd.io/selector: server-2
  ports:
  - name: server-2-port
    port: 8080
    protocol: TCP
# Rendered el-CICD Chart Template -&gt; "service" server-2
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: server-1
    helm.sh/chart: elcicd-chart-0.1.0
  name: server-1
  namespace: elcicd-chart-demo
spec:
  revisionHistoryLimit: 0
  selector:
    matchExpressions:
    - key: elcicd.io/selector
      operator: Exists
    matchLabels:
      elcicd.io/selector: server-1
  template:
    metadata:
      labels:
        app.kubernetes.io/instance: elcicd-chart-demo
        app.kubernetes.io/managed-by: Helm
        elcicd.io/selector: server-1
        helm.sh/chart: elcicd-chart-0.1.0
      name: server-1
      namespace: elcicd-chart-demo
    spec:
      containers:
      - name: server-1
        image: registry.redhat.io/rhel8/httpd-24
        imagePullPolicy: Always
        ports:
        - name: default-port
          containerPort: 8080
          protocol: TCP
        resources:
          limits: {}
          requests: {}
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
        volumeMounts:
        - mountPath: /var/www/html/
          name: elcicd-chart-demo
          readOnly: false
      imagePullSecrets: []
      securityContext:
        runAsNonRoot: true
        seccompProfile:
          type: RuntimeDefault
      volumes:
      - name: elcicd-chart-demo
        projected:
          sources:
          - configMap:
              name: server-1
# Rendered el-CICD Chart Template -&gt; "deployment" server-1
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: server-2
    helm.sh/chart: elcicd-chart-0.1.0
  name: server-2
  namespace: elcicd-chart-demo
spec:
  revisionHistoryLimit: 0
  selector:
    matchExpressions:
    - key: elcicd.io/selector
      operator: Exists
    matchLabels:
      elcicd.io/selector: server-2
  template:
    metadata:
      labels:
        app.kubernetes.io/instance: elcicd-chart-demo
        app.kubernetes.io/managed-by: Helm
        elcicd.io/selector: server-2
        helm.sh/chart: elcicd-chart-0.1.0
      name: server-2
      namespace: elcicd-chart-demo
    spec:
      containers:
      - name: server-2
        image: registry.redhat.io/rhel8/httpd-24
        imagePullPolicy: Always
        ports:
        - name: default-port
          containerPort: 8080
          protocol: TCP
        resources:
          limits: {}
          requests: {}
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
        volumeMounts:
        - mountPath: /var/www/html/
          name: elcicd-chart-demo
          readOnly: false
      imagePullSecrets: []
      securityContext:
        runAsNonRoot: true
        seccompProfile:
          type: RuntimeDefault
      volumes:
      - name: elcicd-chart-demo
        projected:
          sources:
          - configMap:
              name: server-2
# Rendered el-CICD Chart Template -&gt; "deployment" server-2
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.allow-http: "false"
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: server-1
    helm.sh/chart: elcicd-chart-0.1.0
  name: server-1
  namespace: elcicd-chart-demo
spec:
  rules:
  - host: httpd-elcicd-chart-demo-server-1.apps-crc.testing
    http:
      paths:
      - backend:
          service:
            name: server-1
            port:
              number: 8080
        path: /
        pathType: Prefix
  tls:
  - {}
# Rendered YAML Template -&gt; kind: "Ingress" name: "server-1"
---
# Source: elcicd-chart/templates/render.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.allow-http: "false"
  labels:
    app.kubernetes.io/instance: elcicd-chart-demo
    app.kubernetes.io/managed-by: Helm
    elcicd.io/selector: server-2
    helm.sh/chart: elcicd-chart-0.1.0
  name: server-2
  namespace: elcicd-chart-demo
spec:
  rules:
  - host: httpd-elcicd-chart-demo-server-2.apps-crc.testing
    http:
      paths:
      - backend:
          service:
            name: server-2
            port:
              number: 8080
        path: /
        pathType: Prefix
  tls:
  - {}
# Rendered YAML Template -&gt; kind: "Ingress" name: "server-2"
---
# Source: elcicd-chart/templates/render.yaml
# Profiles: []</code></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>
View the running <code>elcicd-chart-demo</code> resources in the cluster:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ kubectl get -n elcicd-chart-demo deploy,rs,pod,cm,service,ingress</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>NAME                            READY   STATUS    RESTARTS   AGE
pod/server-1-7cc699d4c-lr599    1/1     Running   0          3m14s
pod/server-2-584f8cfd57-72cw9   1/1     Running   0          3m14s

NAME                       READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/server-1   1/1     1            1           3m14s
deployment.apps/server-2   1/1     1            1           3m14s

NAME               TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)    AGE
service/server-1   ClusterIP   10.217.4.49   &lt;none&gt;        8080/TCP   3m14s
service/server-2   ClusterIP   10.217.4.59   &lt;none&gt;        8080/TCP   3m14s

NAME                                 CLASS    HOSTS                                               ADDRESS                           PORTS     AGE
ingress.networking.k8s.io/server-1   &lt;none&gt;   httpd-elcicd-chart-demo-server-1.apps-crc.testing   router-default.apps-crc.testing   80, 443   3m14s
ingress.networking.k8s.io/server-2   &lt;none&gt;   httpd-elcicd-chart-demo-server-2.apps-crc.testing   router-default.apps-crc.testing   80, 443   3m14s

NAME                                      HOST/PORT                                           PATH   SERVICES   PORT            TERMINATION     WILDCARD
route.route.openshift.io/server-1-rqvhr   httpd-elcicd-chart-demo-server-1.apps-crc.testing   /      server-1   server-1-port   edge/Redirect   None
route.route.openshift.io/server-2-9nq7k   httpd-elcicd-chart-demo-server-2.apps-crc.testing   /      server-2   server-2-port   edge/Redirect   None

NAME                                 DATA   AGE
configmap/kube-root-ca.crt           1      4d
configmap/openshift-service-ca.crt   1      4d
configmap/server-1                   1      3m14s
configmap/server-2                   1      3m14s</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>Verify each Apache Web Server is reachable:</p>
<div class="paragraph">
<p>Open your browser and go to <a href="https://httpd-elcicd-chart-demo-server-1.apps-crc.testing/" class="bare">https://httpd-elcicd-chart-demo-server-1.apps-crc.testing/</a>, and then the second server, <a href="https://httpd-elcicd-chart-demo-server-2.apps-crc.testing/" class="bare">https://httpd-elcicd-chart-demo-server-2.apps-crc.testing/</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If not using CRC, you&#8217;ll find the URL you&#8217;ll need to point your browser at in the Ingress HOSTS field output
      from the <code>kubectl get</code> command.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="sections/general-steps/images/free-form-templates-screenshot.png" alt="free form templates screenshot">
</div>
</div>
</li>
<li>
<p>
Uninstall the chart.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm uninstall -n elcicd-chart-demo elcicd-chart-demo</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>release "elcicd-chart-demo" uninstalled</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_remove_the_el_cicd_chart_repo">2.7. Remove the el-CICD Chart repo</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ helm repo remove elcicd-charts</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>"elcicd-charts" has been removed from your repositories</code></pre>
</div>
</div>
<div class="paragraph">
<p>This concludes the el-CICD Chart tutorial.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-07-25 22:58:44 UTC
</div>
</div>
</body>
</html>